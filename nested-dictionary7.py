import re

site_data =  {17045: {'metadata': {'wsi_code': 17045, 'icao_code': 'KCVG', 'name': 'COVINGTON', 'latitude': 39.05, 'longitude': -84.6667, 'list_order': 0}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[39.05,-84.6667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17912: {'metadata': {'wsi_code': 17912, 'icao_code': 'KCLE', 'name': 'CLEVELAND', 'latitude': 41.4167, 'longitude': -81.8667, 'list_order': 1}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[41.4167,-81.8667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17447: {'metadata': {'wsi_code': 17447, 'icao_code': 'KSTL', 'name': 'ST LOUIS/LAMBERT', 'latitude': 38.75, 'longitude': -90.3667, 'list_order': 2}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[38.75,-90.3667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 16986: {'metadata': {'wsi_code': 16986, 'icao_code': 'KIND', 'name': 'INDIANAPOLIS', 'latitude': 39.7333, 'longitude': -86.2667, 'list_order': 3}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[39.7333,-86.2667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17246: {'metadata': {'wsi_code': 17246, 'icao_code': 'KDTW', 'name': 'DETROIT/WAYNE', 'latitude': 42.2333, 'longitude': -83.3333, 'list_order': 4}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[42.2333,-83.3333]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17370: {'metadata': {'wsi_code': 17370, 'icao_code': 'KMSP', 'name': 'MINNEAPOLIS', 'latitude': 44.8833, 'longitude': -93.2167, 'list_order': 5}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[44.8833,-93.2167]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17857: {'metadata': {'wsi_code': 17857, 'icao_code': 'KNYC', 'name': 'NYC/CENTRAL PARK', 'latitude': 40.7833, 'longitude': -73.9667, 'list_order': 6}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[40.7833,-73.9667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17161: {'metadata': {'wsi_code': 17161, 'icao_code': 'KBWI', 'name': 'BALTIMORE/INTL', 'latitude': 39.1833, 'longitude': -76.6667, 'list_order': 7}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[39.1833,-76.6667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18414: {'metadata': {'wsi_code': 18414, 'icao_code': 'KORF', 'name': 'NORFOLK', 'latitude': 36.9, 'longitude': -76.2, 'list_order': 8}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[36.9,-76.2]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18418: {'metadata': {'wsi_code': 18418, 'icao_code': 'KRIC', 'name': 'RICHMOND', 'latitude': 37.5, 'longitude': -77.3333, 'list_order': 9}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[37.5,-77.3333]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 16684: {'metadata': {'wsi_code': 16684, 'icao_code': 'KDCA', 'name': 'WASHINGTON/NATL', 'latitude': 38.85, 'longitude': -77.0333, 'list_order': 10}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[38.85,-77.0333]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18598: {'metadata': {'wsi_code': 18598, 'icao_code': 'KCRW', 'name': 'CHARLESTON', 'latitude': 38.3667, 'longitude': -81.6, 'list_order': 11}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[38.3667,-81.6]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17684: {'metadata': {'wsi_code': 17684, 'icao_code': 'KACY', 'name': 'ATLANTIC CITY', 'latitude': 39.45, 'longitude': -74.5667, 'list_order': 12}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[39.45,-74.5667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18090: {'metadata': {'wsi_code': 18090, 'icao_code': 'KPIT', 'name': 'PITTSBURGH', 'latitude': 40.5, 'longitude': -80.2167, 'list_order': 13}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[40.5,-80.2167]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18044: {'metadata': {'wsi_code': 18044, 'icao_code': 'KABE', 'name': 'ALLENTOWN', 'latitude': 40.65, 'longitude': -75.4333, 'list_order': 14}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[40.65,-75.4333]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17697: {'metadata': {'wsi_code': 17697, 'icao_code': 'KEWR', 'name': 'NEWARK', 'latitude': 40.7, 'longitude': -74.1667, 'list_order': 15}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[40.7,-74.1667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17921: {'metadata': {'wsi_code': 17921, 'icao_code': 'KDAY', 'name': 'DAYTON', 'latitude': 39.9, 'longitude': -84.2, 'list_order': 16}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[39.9,-84.2]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 17917: {'metadata': {'wsi_code': 17917, 'icao_code': 'KCMH', 'name': 'COLUMBUS', 'latitude': 40.0, 'longitude': -82.8833, 'list_order': 17}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[40.0,-82.8833]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18085: {'metadata': {'wsi_code': 18085, 'icao_code': 'KPHL', 'name': 'PHILADELPHIA', 'latitude': 39.8833, 'longitude': -75.25, 'list_order': 18}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[39.8833,-75.25]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}, 18420: {'metadata': {'wsi_code': 18420, 'icao_code': 'KROA', 'name': 'ROANOKE', 'latitude': 37.3167, 'longitude': -79.9667, 'list_order': 19}, 'APICall': 'http://api.weatheranalytics.com/v2/wsi/metar/[37.3167,-79.9667]?startDate=06/28/2021&endDate=06/30/2021&interval=hourly&units=imperial&format=xml&userKey=4449f2f578c59aa4eb638a9c5d39ec52&time=lwt&limit=25', 'obs': {'2021-06-28T04:00:00Z': {'dateHrGmt': '06/28/2021 04:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 63.3, 'SurfaceDewpointTemperatureFahrenheit': 68.8, 'SurfaceWetBulbTemperatureFahrenheit': 50.5}, '2021-06-28T05:00:00Z': {'dateHrGmt': '06/28/2021 05:00:00', 'dateHrLwt': '06/28/2021 00:00:00', 'SurfaceTemperatureFahrenheit': 65.5, 'SurfaceDewpointTemperatureFahrenheit': 69.9, 'SurfaceWetBulbTemperatureFahrenheit': 61.5}}}}


customer_data =  {'NOEL': {'NOELTESTPROD': {'station_list': 'NOELTEST', 'post_proc': ''}, 'NOELTESTPROD2': {'station_list': 'NOELTEST2', 'post_proc': ''}}, 'GBE': {'GBESOLAROBS': {'station_list': 'gbe_solar_stn', 'post_proc': 'proc_gbe_solar', 'stations': {'0': 17045, '1': 17912, '2': 17447, '3': 16986, '4': 17246, '5': 17370, '6': 17857, '7': 17161, '8': 18414, '9': 18418, '10': 16684, '11': 18598, '12': 17684, '13': 18090, '14': 18044, '15': 17697, '16': 17921, '17': 17917, '18': 18085, '19': 18420}}}}

def FormatDate(raw_date):

    #OLD: 10/17/2015 5:00:00 AM
    #NEW: 2015-10-17 00:00:00.0
    print("raw_date = ", raw_date)
    formatted_date = ""

    default_match = re.match(r'(\d+)-(\d+)-(\d+) (\d+):(\d+):(\d+)',raw_date)
    print("default_match = ", default_match)

    if default_match:
        mm = default_match.group(2)
        dd = default_match.group(3)
        yyyy = default_match.group(1)

        hh = default_match.group(4)

        print(default_match.group(1), default_match.group(2), default_match.group(3), default_match.group(4), default_match.group(5), default_match.group(6))

        formatted_date = f"{yyyy}/{mm}/{dd} {hh}"
    else:
        formatted_date = f"{raw_date}"

    return formatted_date

key_to_lookup = 'stations'

for customer in customer_data:
    for product in customer_data[customer]:
        print("product = ", product)

        #loop over each station
        print(f"{customer} --> {product}")
        if key_to_lookup in customer_data[customer][product]:
            for site_index in customer_data[customer][product]['stations']:
                site_id = customer_data[customer][product]['stations'][site_index]
                if 'name' in site_data[site_id]['metadata']:
                    site_name = site_data[site_id]['metadata']['name']
                else:
                    site_name = ''
                if 'icao_code' in site_data[site_id]['metadata']:
                    icao = site_data[site_id]['metadata']['icao_code']
                else:
                    icao = ''

                #Trim trailing white space from site name
                site_name=re.sub(r'\s+$','',site_name)

                #loop over each time period
                if 'obs' in site_data[site_id]:
                    for valid_time in site_data[site_id]['obs']:

                        DateHrLwt_parts = []
                        print("check the inpurt for site_data[site_id]['obs'][valid_time]['dateHrLwt']", site_data[site_id]['obs'][valid_time]['dateHrLwt'])
                        MyFormatDate = FormatDate(site_data[site_id]['obs'][valid_time]['dateHrLwt'])
                        print("site_data[site_id]['obs'][valid_time]['SurfaceTemperatureFahrenheit'] = ", site_data[site_id]['obs'][valid_time]['SurfaceTemperatureFahrenheit'])
                        Tsfc = ("%.0f") %(site_data[site_id]['obs'][valid_time]['SurfaceTemperatureFahrenheit'])
                        print("Tsfc = ", Tsfc)
                        Rh = site_data[site_id]['obs'][valid_time]['RelativeHumidity']
